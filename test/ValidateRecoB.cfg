process BTagValidator =  {

  #keep the logging output to a nice level
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  source = PoolSource {
    untracked vstring fileNames = {
        #'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt50_80.CMSSW_1_3_0_pre3.root',
	#'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt80_120.CMSSW_1_3_0_pre3.root'
       
  	#'/store/RelVal/2006/12/16/RelVal120BJets50-120/0000/00D1599A-578D-DB11-8741-001731AF68C7.root'
'/store/unmerged/mc/2007/10/31/RelVal-RelValTTbar-1193838485/GEN-SIM-DIGI-RECO/0000/00437287-C687-DC11-BDFE-000423D98B28.root',
'/store/unmerged/mc/2007/10/31/RelVal-RelValTTbar-1193838485/GEN-SIM-DIGI-RECO/0000/00DB4C9C-C687-DC11-BC34-000423D98800.root'

    }
    
  }
  untracked PSet maxEvents = {untracked int32 input = 5000 }

  include "Validation/RecoB/test/the_data.cfg"

#include "RecoBTag/Analysis/data/bTagAnalysis.cfi"

module bTagAnalysis = BTagPerformanceAnalyzer {

    VPSet tagConfig = {
      {
        InputTag label = trackCountingHighEffBJetTags
        include "RecoBTag/Analysis/data/bTagTrackCountingAnalysis.cff"
      } , {
        InputTag label = trackCountingHighPurBJetTags
        include "RecoBTag/Analysis/data/bTagTrackCountingAnalysis.cff"
      } , {
        InputTag label = impactParameterTagInfos
        string   type   = "TrackIP"
        include "RecoBTag/Analysis/data/bTagTrackIPAnalysis.cff"
      }, {
        InputTag label = jetProbabilityBJetTags
        include "Validation/RecoB/data/trackProbabilityAnalysis.cff"
      } , {
        InputTag label = softElectronBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } , {
        InputTag label = softMuonBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } ,  {
        InputTag label = jetBProbabilityBJetTags
        include "RecoBTag/Analysis/data/bTagTrackBProbabilityAnalysis.cff"
      } , {
        InputTag label = impactParameterMVABJetTags
        include "RecoBTag/Analysis/data/bTagImpactParameterMVAAnalysis.cff"
      } , {
        InputTag label = combinedSecondaryVertexMVABJetTags
        include "RecoBTag/Analysis/data/bTagGenericAnalysis.cff"
      } , {
        InputTag label = combinedSecondaryVertexBJetTags
        include "RecoBTag/Analysis/data/bTagCombinedSVAnalysis.cff"
      } ,  {
        InputTag label = simpleSecondaryVertexBJetTags
        include "RecoBTag/Analysis/data/bTagSimpleSVAnalysis.cff"
      } , {
        InputTag label = softMuonNoIPBJetTags
        include "RecoBTag/Analysis/data/bTagSoftLeptonAnalysis.cff"
      } 

    }

    # output root file
    string rootfile = "jetTagAnalysis.root"

    # parameters common to all tagger algorithms
    include "RecoBTag/Analysis/data/bTagAnalysis.cff"
}

  replace bTagAnalysis.allHistograms = true
  replace bTagAnalysis.rootfile = "jetTagAnalysis.root"
  replace bTagAnalysis.producePs = false

# replace bJetTagAnalysis.jetTagModuleLabel = { trackCountingHighEffBJetTags, trackCountingHighPurBJetTags,jetProbabilityBJetTags,combinedSVBJetTags,impactParameterMVABJetTags,combinedSVMVABJetTags}
# replace bJetTagAnalysis.dataFormatType = { "JetTag", "JetTag","JetTag","JetTag","JetTag","JetTag"}

#  path p = {bTagAnalysis}

  

########################################################
  
  module TrackCountingHighPurValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/jetFlavour_trackCountingHighPurBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/discr_trackCountingHighPurBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighPurBJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighPurBJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/effVsDiscrCut_discrFC_trackCountingHighPurBJetTags_GLOBALB",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/effVsDiscrCut_discrFC_trackCountingHighPurBJetTags_GLOBALDUSG"
}
    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackCountingHighPur"

	  }

  #replace TrackCountingValidator.producePs = false
  
########################################################

  module TrackCountingHighEffValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/jetFlavour_trackCountingHighEffBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/discr_trackCountingHighEffBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighEffBJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighEffBJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/effVsDiscrCut_discrFC_trackCountingHighEffBJetTags_GLOBALB",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/effVsDiscrCut_discrFC_trackCountingHighEffBJetTags_GLOBALDUSG"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackCountingHighEff"

	  }

  #replace TrackCountingValidator.producePs = false
  
########################################################

  module TrackProbabilityValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_jetProbabilityBJetTags_GLOBAL/jetFlavour_jetProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/discr_jetProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_jetProbabilityBJetTags_GLOBAL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_jetProbabilityBJetTags_GLOBAL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/effVsDiscrCut_discrFC_jetProbabilityBJetTags_GLOBALB",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/effVsDiscrCut_discrFC_jetProbabilityBJetTags_GLOBALDUSG" 
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackProbability"
   }
  
  #replace TrackProbabilityValidator.producePs = false

########################################################

  module TrackBProbabilityValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/jetFlavour_jetBProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/discr_jetBProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_jetBProbabilityBJetTags_GLOBAL",
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_jetBProbabilityBJetTags_GLOBAL",
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/effVsDiscrCut_discrFC_jetBProbabilityBJetTags_GLOBALB",
      "/JetTag_jetBProbabilityBJetTags_GLOBAL/effVsDiscrCut_discrFC_jetBProbabilityBJetTags_GLOBALDUSG"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackBProbability"
   }

########################################################

  module impactParameterMVAValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_impactParameterMVABJetTags_GLOBAL/jetFlavour_impactParameterMVABJetTags_GLOBALALL",
      "/JetTag_impactParameterMVABJetTags_GLOBAL/discr_impactParameterMVABJetTags_GLOBALALL",
      "/JetTag_impactParameterMVABJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_impactParameterMVABJetTags_GLOBAL",
      "/JetTag_impactParameterMVABJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_impactParameterMVABJetTags_GLOBAL",
      "/JetTag_impactParameterMVABBJetTags_GLOBAL/effVsDiscrCut_discrFC_impactParameterMVABBJetTags_GLOBALB",
      "/JetTag_impactParameterMVABBJetTags_GLOBAL/effVsDiscrCut_discrFC_impactParameterMVABBJetTags_GLOBALDUSG"
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "impactParameterMVA"
   }

########################################################

  module simpleSecondaryVertexValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/jetFlavour_simpleSecondaryVertexBJetTags_GLOBALALL",
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/discr_simpleSecondaryVertexBJetTags_GLOBALALL",
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_simpleSecondaryVertexBJetTags_GLOBAL",
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_simpleSecondaryVertexBJetTags_GLOBAL",
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/effVsDiscrCut_discrFC_simpleSecondaryVertexBJetTags_GLOBALB",
      "/JetTag_simpleSecondaryVertexBJetTags_GLOBAL/effVsDiscrCut_discrFC_simpleSecondaryVertexBJetTags_GLOBALDUSG"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "simpleSecondaryVertex"
   }

 ########################################################

  module SoftLeptonValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_softElectronBJetTags_GLOBAL/jetFlavour_softElectronBJetTags_GLOBALALL",
      "/JetTag_softElectronBJetTags_GLOBAL/discr_softElectronBJetTags_GLOBALALL",
      "/JetTag_softElectronBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softElectronBJetTags_GLOBAL",
      "/JetTag_softElectronBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softElectronBJetTags_GLOBAL",
      "/JetTag_softElectronBJetTags_GLOBAL/effVsDiscrCut_discrFC_softElectronBJetTags_GLOBALB",
      "/JetTag_softElectronBJetTags_GLOBAL/effVsDiscrCut_discrFC_softElectronBJetTags_GLOBALDUSG",  

      "/JetTag_softMuonBJetTags_GLOBAL/jetFlavour_softMuonBJetTags_GLOBALALL",
      "/JetTag_softMuonBJetTags_GLOBAL/discr_softMuonBJetTags_GLOBALALL",
      "/JetTag_softMuonBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softMuonBJetTags_GLOBAL",
      "/JetTag_softMuonBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softMuonBJetTags_GLOBAL",
      "/JetTag_softMuonBJetTags_GLOBAL/effVsDiscrCut_discrFC_softMuonBJetTags_GLOBALB",
      "/JetTag_softMuonBJetTags_GLOBAL/effVsDiscrCut_discrFC_softMuonBJetTags_GLOBALDUSG"    
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "SoftLepton"
   }
  
  #replace SoftLeptonValidator.producePs = false

 ########################################################

  module SoftMuonNoIPValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/jetFlavour_softMuonNoIPBJetTags_GLOBALALL",
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/discr_softMuonNoIPBJetTags_GLOBALALL",
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softMuonNoIPBJetTags_GLOBAL",
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softMuonNoIPBJetTags_GLOBAL",
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/effVsDiscrCut_discrFC_softMuonNoIPBJetTags_GLOBALB",
      "/JetTag_softMuonNoIPBJetTags_GLOBAL/effVsDiscrCut_discrFC_softMuonNoIPBJetTags_GLOBALDUSG"
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "SoftMuonNoIP"
   }
  
  #replace SoftLeptonValidator.producePs = false

########################################################


  module combinedSecondaryVertexValidator = BTagValidator {

    # histograms selected for validation
    vstring histogramList = {
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/jetFlavour_combinedSecondaryVertexBJetTags_GLOBALALL",
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/discr_combinedSecondaryVertexBJetTags_GLOBALALL",
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSecondaryVertexBJetTags_GLOBAL",
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSecondaryVertexBJetTags_GLOBAL",
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/effVsDiscrCut_discrFC_combinedSecondaryVertexBJetTags_GLOBALB",
      "/JetTag_combinedSecondaryVertexBJetTags_GLOBAL/effVsDiscrCut_discrFC_combinedSecondaryVertexBJetTags_GLOBALDUSG"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "combinedsecondaryVertex"
  }

  #replace CombinedSVMVAValidator.producePs = false

########################################################


  module combinedSecondaryVertexMVAValidator = BTagValidator {

    # histograms selected for validation
    vstring histogramList = {
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/jetFlavour_combinedSecondaryVertexMVABJetTags_GLOBALALL",
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/discr_combinedSecondaryVertexBJetTags_GLOBALALL",
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSecondaryVertexMVABJetTags_GLOBAL",
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSecondaryVertexMVABJetTags_GLOBAL",
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/effVsDiscrCut_discrFC_combinedSecondaryVertexMVABJetTags_GLOBALB",
      "/JetTag_combinedSecondaryVertexMVABJetTags_GLOBAL/effVsDiscrCut_discrFC_combinedSecondaryVertexMVABJetTags_GLOBALDUSG"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "combinedsecondaryVertexMVA"
  }

  #replace CombinedSVMVAValidator.producePs = false

########################################################



  service = DaqMonitorROOTBackEnd{}

  path p = {bTagAnalysis, TrackCountingHighPurValidator, TrackCountingHighEffValidator,TrackProbabilityValidator, TrackBProbabilityValidator,impactParameterMVAValidator, simpleSecondaryVertexValidator, SoftLeptonValidator, SoftMuonNoIPValidator, combinedSecondaryVertexValidator, combinedSecondaryVertexMVAValidator}
#  path p = { bTagAnalysis, TrackCountingValidator, TrackProbabilityValidator, SoftLeptonValidator, secondaryVertexValidator }

}

