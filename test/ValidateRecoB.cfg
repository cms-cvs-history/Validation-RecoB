process BTagValidator =  {

  #keep the logging output to a nice level
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  source = PoolSource {
    untracked vstring fileNames = {
        #'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt50_80.CMSSW_1_3_0_pre3.root',
	#'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt80_120.CMSSW_1_3_0_pre3.root'
       
  	#'/store/RelVal/2006/12/16/RelVal120BJets50-120/0000/00D1599A-578D-DB11-8741-001731AF68C7.root'
	'/store/RelVal/2007/7/10/RelVal-RelVal152BJets50-120-1184059625/0000/164AA33D-022F-DC11-B0AB-000423D99F1E.root'
    }
    
  }
  untracked PSet maxEvents = {untracked int32 input = -1}

  include "Validation/RecoB/test/the_data.cfg"

  #include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"
  #include "RecoBTag/TrackProbability/data/trackProbability.cff"


  include "RecoBTau/Configuration/data/RecoBTau_FrontierConditions.cff"
  include "RecoBTau/Configuration/data/RecoBTau.cff"
  
########################################################
  
  module TrackCountingValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_trackCountingHighPurJetTags_GLOBAL/jetFlavour_trackCountingHighPurJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurJetTags_GLOBAL/discr_trackCountingHighPurJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_trackCountingHighPurJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighPurJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighPurJetTags_GLOBAL",

      "/JetTag_trackCountingHighEffJetTags_GLOBAL/jetFlavour_trackCountingHighEffJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffJetTags_GLOBAL/discr_trackCountingHighEffJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_trackCountingHighEffJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighEffJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighEffJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
  }

  replace TrackCountingValidator.producePs = false
  
########################################################

  module TrackProbabilityValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_jetProbabilityJetTags_GLOBAL/jetFlavour_jetProbabilityJetTags_GLOBALALL",
      "/JetTag_jetProbabilityJetTags_GLOBAL/discr_jetProbabilityJetTags_GLOBALALL",
      "/JetTag_jetProbabilityJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_jetProbabilityJetTags_GLOBAL",
      "/JetTag_jetProbabilityJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_jetProbabilityJetTags_GLOBAL",
      "/JetTag_jetProbabilityJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_jetProbabilityJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
  }
  
  replace TrackProbabilityValidator.producePs = false

########################################################

  module SoftLeptonValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_softElectronJetTags_GLOBAL/jetFlavour_softElectronJetTags_GLOBALALL",
      "/JetTag_softElectronJetTags_GLOBAL/discr_softElectronJetTags_GLOBALALL",
      "/JetTag_softElectronJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_softElectronJetTags_GLOBAL",
      "/JetTag_softElectronJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softElectronJetTags_GLOBAL",
      "/JetTag_softElectronJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softElectronJetTags_GLOBAL",

      "/JetTag_softMuonJetTags_GLOBAL/jetFlavour_softMuonJetTags_GLOBALALL",
      "/JetTag_softMuonJetTags_GLOBAL/discr_softMuonJetTags_GLOBALALL",
      "/JetTag_softMuonJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_softMuonJetTags_GLOBAL",
      "/JetTag_softMuonJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softMuonJetTags_GLOBAL",
      "/JetTag_softMuonJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softMuonJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
  }
  
  replace SoftLeptonValidator.producePs = false

########################################################

  module CombinedSVValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_combinedSVJetTags_GLOBAL/jetFlavour_combinedSVJetTags_GLOBALALL",
      "/JetTag_combinedSVJetTags_GLOBAL/discr_combinedSVJetTags_GLOBALALL",
      "/JetTag_combinedSVJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_combinedSVJetTags_GLOBAL",
      "/JetTag_combinedSVJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSVJetTags_GLOBAL",
      "/JetTag_combinedSVJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSVJetTags_GLOBAL"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
  }
  
  replace CombinedSVValidator.producePs = false

########################################################

  module CombinedSVMVAValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_combinedSVMVAJetTags_GLOBAL/jetFlavour_combinedSVMVAJetTags_GLOBALALL",
      "/JetTag_combinedSVMVAJetTags_GLOBAL/discr_combinedSVMVAJetTags_GLOBALALL",
      "/JetTag_combinedSVMVAJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_combinedSVMVAJetTags_GLOBAL",
      "/JetTag_combinedSVMVAJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSVMVAJetTags_GLOBAL",
      "/JetTag_combinedSVMVAJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSVMVAJetTags_GLOBAL"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
  }
  
  replace CombinedSVMVAValidator.producePs = false

 
########################################################

module bTagAnalysis = BTagPerformanceAnalyzer {
  
    VPSet tagConfig = {
      { 
        InputTag label = trackCountingHighEffBJetTags
        include "Validation/RecoB/data/trackCountingAnalysis.cff"
      } , {
        InputTag label = trackCountingHighPurBJetTags
        include "Validation/RecoB/data/trackCountingAnalysis.cff"
      } , {
        InputTag label = jetProbabilityBJetTags
        include "Validation/RecoB/data/trackProbabilityAnalysis.cff"
      } , {
        InputTag label = softElectronBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } , {
        InputTag label = softMuonBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } , {
        InputTag label = combinedSVBJetTags
        include "Validation/RecoB/data/combinedSVAnalysis.cff"
      } , {
        InputTag label = combinedSVMVABJetTags
        include "Validation/RecoB/data/combinedSVMVAAnalysis.cff"
      }
    }

    # output root file
    string rootfile = "jetTagAnalysis.root"

    # parameters common to all tagger algorithms
    include "RecoBTag/Analysis/data/bTagAnalysis.cff"
}

  service = DaqMonitorROOTBackEnd{}

  path p = { bTagAnalysis, TrackCountingValidator, TrackProbabilityValidator, SoftLeptonValidator, CombinedSVValidator, CombinedSVMVAValidator }

}
