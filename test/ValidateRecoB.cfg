process BTagValidator =  {

  #keep the logging output to a nice level
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  source = PoolSource {
    untracked vstring fileNames = {
        #'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt50_80.CMSSW_1_3_0_pre3.root',
	#'castor:/castor/cern.ch/user/f/fpschill/btag/RelVal120QCD_pt80_120.CMSSW_1_3_0_pre3.root'
       
  	#'/store/RelVal/2006/12/16/RelVal120BJets50-120/0000/00D1599A-578D-DB11-8741-001731AF68C7.root'
'/store/unmerged/mc/2007/10/31/RelVal-RelValTTbar-1193838485/GEN-SIM-DIGI-RECO/0000/00437287-C687-DC11-BDFE-000423D98B28.root',
'/store/unmerged/mc/2007/10/31/RelVal-RelValTTbar-1193838485/GEN-SIM-DIGI-RECO/0000/00DB4C9C-C687-DC11-BC34-000423D98800.root'

    }
    
  }
  untracked PSet maxEvents = {untracked int32 input = 5000 }

  include "Validation/RecoB/test/the_data.cfg"

#include "RecoBTag/Analysis/data/bTagAnalysis.cfi"

module bTagAnalysis = BTagPerformanceAnalyzer {

    VPSet tagConfig = {
      {
        InputTag label = trackCountingHighEffBJetTags
        include "RecoBTag/Analysis/data/bTagTrackCountingAnalysis.cff"
      } , {
        InputTag label = trackCountingHighPurBJetTags
        include "RecoBTag/Analysis/data/bTagTrackCountingAnalysis.cff"
      } , {
        InputTag label = impactParameterTagInfos
        string   type   = "TrackIP"
        include "RecoBTag/Analysis/data/bTagTrackIPAnalysis.cff"
      }, {
        InputTag label = jetProbabilityBJetTags
        include "Validation/RecoB/data/trackProbabilityAnalysis.cff"
      } , {
        InputTag label = softElectronBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } , {
        InputTag label = softMuonBJetTags
	include "Validation/RecoB/data/softLeptonAnalysis.cff"
      } , {
        InputTag label = combinedSVBJetTags
        include "Validation/RecoB/data/combinedSVAnalysis.cff"
      } , {
        InputTag label = combinedSVMVABJetTags
        include "Validation/RecoB/data/combinedSVMVAAnalysis.cff"
      } , {
        InputTag label = secondaryVertexBJetTags
	include "Validation/RecoB/data/combinedSVAnalysis.cff"      
	}

    }

    # output root file
    string rootfile = "jetTagAnalysis.root"

    # parameters common to all tagger algorithms
    include "RecoBTag/Analysis/data/bTagAnalysis.cff"
}

	replace bTagAnalysis.allHistograms = true
  replace bTagAnalysis.rootfile = "jetTagAnalysis.root"
# replace bJetTagAnalysis.jetTagModuleLabel = { trackCountingHighEffBJetTags, trackCountingHighPurBJetTags,jetProbabilityBJetTags,combinedSVBJetTags,impactParameterMVABJetTags,combinedSVMVABJetTags}
# replace bJetTagAnalysis.dataFormatType = { "JetTag", "JetTag","JetTag","JetTag","JetTag","JetTag"}

#  path p = {bTagAnalysis}

  
########################################################
  
  module TrackCountingValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/jetFlavour_trackCountingHighPurBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/discr_trackCountingHighPurBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_trackCountingHighPurBJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighPurBJetTags_GLOBAL",
      "/JetTag_trackCountingHighPurBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighPurBJetTags_GLOBAL",

      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/jetFlavour_trackCountingHighEffBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/discr_trackCountingHighEffBJetTags_GLOBALALL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_trackCountingHighEffBJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_trackCountingHighEffBJetTags_GLOBAL",
      "/JetTag_trackCountingHighEffBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_trackCountingHighEffBJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackCounting"

	  }

  #replace TrackCountingValidator.producePs = false
  
########################################################

  module TrackProbabilityValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_jetProbabilityBJetTags_GLOBAL/jetFlavour_jetProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/discr_jetProbabilityBJetTags_GLOBALALL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_jetProbabilityBJetTags_GLOBAL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_jetProbabilityBJetTags_GLOBAL",
      "/JetTag_jetProbabilityBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_jetProbabilityBJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "TrackProbability"
   }
  
  #replace TrackProbabilityValidator.producePs = false

########################################################

  module SoftLeptonValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_softElectronBJetTags_GLOBAL/jetFlavour_softElectronBJetTags_GLOBALALL",
      "/JetTag_softElectronBJetTags_GLOBAL/discr_softElectronBJetTags_GLOBALALL",
      "/JetTag_softElectronBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_softElectronBJetTags_GLOBAL",
      "/JetTag_softElectronBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softElectronBJetTags_GLOBAL",
      "/JetTag_softElectronBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softElectronBJetTags_GLOBAL",

      "/JetTag_softMuonBJetTags_GLOBAL/jetFlavour_softMuonBJetTags_GLOBALALL",
      "/JetTag_softMuonBJetTags_GLOBAL/discr_softMuonBJetTags_GLOBALALL",
      "/JetTag_softMuonBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_softMuonBJetTags_GLOBAL",
      "/JetTag_softMuonBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_softMuonBJetTags_GLOBAL",
      "/JetTag_softMuonBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_softMuonBJetTags_GLOBAL"  
    }

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "SoftLepton"
   }
  
  #replace SoftLeptonValidator.producePs = false

########################################################

  module CombinedSVValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_combinedSVBJetTags_GLOBAL/jetFlavour_combinedSVBJetTags_GLOBALALL",
      "/JetTag_combinedSVBJetTags_GLOBAL/discr_combinedSVBJetTags_GLOBALALL",
      "/JetTag_combinedSVBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_combinedSVBJetTags_GLOBAL",
      "/JetTag_combinedSVBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSVBJetTags_GLOBAL",
      "/JetTag_combinedSVBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSVBJetTags_GLOBAL"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "CombinedSV"
   }
  
  #replace CombinedSVValidator.producePs = false

########################################################

  module CombinedSVMVAValidator = BTagValidator { 

    # histograms selected for validation
    vstring histogramList = { 
      "/JetTag_combinedSVMVABJetTags_GLOBAL/jetFlavour_combinedSVMVABJetTags_GLOBALALL",
      "/JetTag_combinedSVMVABJetTags_GLOBAL/discr_combinedSVMVABJetTags_GLOBALALL",
      "/JetTag_combinedSVMVABJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_combinedSVMVABJetTags_GLOBAL",
      "/JetTag_combinedSVMVABJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_combinedSVMVABJetTags_GLOBAL",
      "/JetTag_combinedSVMVABJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_combinedSVMVABJetTags_GLOBAL"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "CombinedSVMVA"
  }
  
  #replace CombinedSVMVAValidator.producePs = false

 
########################################################


  module secondaryVertexValidator = BTagValidator {

    # histograms selected for validation
    vstring histogramList = {
      "/JetTag_secondaryVertexBJetTags_GLOBAL/jetFlavour_secondaryVertexBJetTags_GLOBALALL",
      "/JetTag_secondaryVertexBJetTags_GLOBAL/discr_secondaryVertexBJetTags_GLOBALALL",
      "/JetTag_secondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_B_discrFC_secondaryVertexBJetTags_GLOBAL",
      "/JetTag_secondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_C_discrFC_secondaryVertexBJetTags_GLOBAL",
      "/JetTag_secondaryVertexBJetTags_GLOBAL/FlavEffVsBEff_DUSG_discrFC_secondaryVertexBJetTags_GLOBAL"
    }
    // flag for analysis
    bool doAnalysis = true

    // The name of the output root file
    string rootfile = "jetTagAnalysis.root"

    # name of the current reference file
    string DQMFile = "validation.root"

    string referenceFilename = "testReference.root"
    bool compareHistograms = false
    string algorithm = "secondaryVertex"
  }

  #replace CombinedSVMVAValidator.producePs = false


########################################################



  service = DaqMonitorROOTBackEnd{}

  path p = { bTagAnalysis, TrackCountingValidator, TrackProbabilityValidator, SoftLeptonValidator, secondaryVertexValidator }

}

